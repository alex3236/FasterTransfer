# :rocket: FasterTransfer

[![](https://pic.stackoverflow.wiki/uploadImages/117/24/20/154/2021/08/24/23/08/8cd61849-6a34-4e2d-ad3a-c6056adef05e.svg)](https://github.com/Fallen-Breath/MCDReforged)

è®© **ä»»ä½• MCDR æ’ä»¶**ï¼Œæ¯”å¦‚ QuickBackupM çš„ç½‘ç»œæ–‡ä»¶ä¼ è¾“æ›´è¿…é€Ÿï¼

## :warning: æ³¨æ„

:earth_asia:  **æ­¤æ’ä»¶ä»…å¯¹ç½‘ç»œä¼ è¾“ï¼ˆå¦‚å¤‡ä»½åˆ° NASï¼‰çš„ç”¨æˆ·æœ‰æ•ˆã€‚**

:gear: **æ­¤æ’ä»¶ä»…å¯¹ä½¿ç”¨ `shutil.copy*` æ–¹æ³•çš„æ’ä»¶æœ‰æ•ˆã€‚**

:question: **ç†è®ºä¸Šï¼Œæ­¤æ’ä»¶ä¸ä¼šé€ æˆæ–‡ä»¶ä¼ è¾“å¼‚å¸¸ã€‚ä½†å¦‚æœä½ å‘ç°å…¶ä»–æ’ä»¶å‡ºç°äº†æœªçŸ¥åŸå› çš„æ–‡ä»¶ä¼ è¾“å¼‚å¸¸ï¼Œå°è¯•ç¦ç”¨æ­¤æ’ä»¶ã€‚**

:open_file_folder:  **åªæœ‰å½“æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶éƒ½åœ¨åŒä¸€ä¸ª SMB1(CIFS)/2/3 æ–‡ä»¶ç³»ç»Ÿä¸Šæ—¶ï¼Œæ­¤æ’ä»¶ç”Ÿæ•ˆã€‚**

## :door:		å‰ç½®

- speedcopy

## :page_facing_up: ä½¿ç”¨è¯´æ˜

åªéœ€è¦æ‰”è¿›æ’ä»¶æ–‡ä»¶å¤¹å¹¶æ­£å¸¸è½½å…¥ã€‚æ— éœ€ä»»ä½•é…ç½®ã€‚

### :arrow_forward:	å¯ç”¨æ’ä»¶

```plain
è‹¥å·²ç¦ç”¨:
!!MCDR plugin enable FasterTransfer-vx.x.x.mcdr.disabled
è‹¥æœªç¦ç”¨:
!!MCDR plugin enable FasterTransfer-vx.x.x.mcdr
```

### :stop_button: ç¦ç”¨æ’ä»¶

```plain
!!MCDR plugin disable faster_transfer
```

## :gear: åŸç†

ä½¿ç”¨ [speedcopy](https://github.com/antirotor/speedcopy) åº“å¯¹ `shutil.copyfile` è¿›è¡Œè¡¥ä¸ã€‚speedcopy å¯¹å…¶çš„æè¿°å¦‚ä¸‹ï¼š

> Patched python shutil.copyfile using native call CopyFile2 on windows to accelerate transfer on windows shares. On Linux, it issues special ioctl command CIFS_IOC_COPYCHUNK_FILE to enable server-side copy.

## ğŸ§ª æµ‹è¯•

ä½¿ç”¨ speedcopy è‡ªå¸¦çš„ [benchmark.py](https://github.com/antirotor/speedcopy/blob/develop/benchmark.py) è¿›è¡Œæµ‹è¯•ã€‚

#### Windows æœ¬åœ°ä¼ è¾“

| File Size (Mb) | shutil    | speedcopy | Boost |
|----------------|-----------|-----------|-------|
| 1              | 0.001648  | 0.001188  | 1.39  |
| 2              | 0.002469  | 0.002038  | 1.21  |
| 4              | 0.004557  | 0.004314  | 1.06  |
| 8              | 0.008214  | 0.007292  | 1.13  |
| 16             | 0.014797  | 0.015179  | 0.97  |
| 32             | 0.031783  | 0.029366  | 1.08  |
| 64             | 0.577100  | 0.564356  | 1.02  |
| 128            | 0.117948  | 0.110211  | 1.07  |
| 256            | 0.289941  | 0.223379  | 1.30  |
| 512            | 1.144847  | 1.259522  | 0.91  |

#### Windows å±€åŸŸç½‘ä¼ è¾“

| File Size (Mb) | shutil     | speedcopy  | Boost  |
|----------------|------------|------------|--------|
| 1              | 0.043559   | 0.025601   | 1.70   |
| 2              | 0.140894   | 0.068142   | 2.07   |
| 4              | 0.317707   | 0.120199   | 2.64   |
| 8              | 0.624333   | 0.050211   | 12.43  |
| 16             | 1.304758   | 0.105648   | 12.35  |
| 32             | 2.312098   | 0.066612   | 34.71  |
| 64             | 25.437534  | 6.052502   | 4.20   |
| 128            | 19.883221  | 0.203415   | 97.75  |
| 256            | 63.355960  | 15.306027  | 4.14   |
| 512            | 32.945394  | 21.032490  | 1.57   |

#### Linux æœ¬åœ°ä¼ è¾“

| File Size (Mb) | shutil    | speedcopy | Boost |
|----------------|-----------|-----------|-------|
| 1              | 0.005928  | 0.007161  | 0.83  |
| 2              | 0.014908  | 0.014864  | 1.00  |
| 4              | 0.029801  | 0.029778  | 1.00  |
| 8              | 0.060115  | 0.059993  | 1.00  |
| 16             | 0.120967  | 0.119723  | 1.01  |
| 32             | 0.240052  | 0.239115  | 1.00  |

#### Linux å±€åŸŸç½‘ä¼ è¾“ï¼ˆspeedcopy å®˜æ–¹æ•°æ®ï¼‰

| File Size (Mb) | shutil | speedcopy | Boost |
| --- | --- | --- | --- |
| 1 | 0.0682 | 0.0099 | 6.88 |
| 2 | 0.0894 | 0.0105 | 8.51 |
| 4 | 0.1337 | 0.012 | 11.14 |
| 8 | 0.1922 | 0.0145 | 13.25 |
| 16 | 0.2853 | 0.0193 | 14.78 |
| 32 | 0.4724 | 0.0288 | 16.4 |
| 64 | 8.0071 | 0.4724 | 16.94 |
| 128 | 1.3338 | 0.2311 | 5.77 |
| 256 | 2.6599 | 0.4788 | 5.55 |
| 512 | 5.3798 | 0.9796 | 5.49 |
| 1024 | 10.3328 | 2.9180 | 3.54 |

### ğŸ’¯ ç»“è®º
åªå»ºè®®ä½¿ç”¨ç½‘ç»œæ–‡ä»¶ä¼ è¾“ï¼ˆNAS ç­‰ï¼‰çš„ç”¨æˆ·ä½¿ç”¨ã€‚

